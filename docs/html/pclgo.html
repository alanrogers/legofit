<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: pclgo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site patterns.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">pclgo </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Re-express free variables in terms of principal components.</p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers </dd></dl>
<h1 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
pclgo: re-express free variables in terms of principal components.</h1>
<p>First run <span class="tt">legofit</span> on a series of bootstrap or simulation replicates to produce a series of .legofiles. All these <span class="tt">legofit</span> runs should use the same .lgo file. <span class="tt">pclgo</span> reads this .lgo file and also all the .legofit files. It uses the .legofit files to do a principal components analysis of the free variables, and then rewrites a portion of the .lgo file, re-expressing all the free variables as linear functions of the principle components. In the rewrite, all the free variables are principal component scores and are therefore uncorrelated. The output of pclgo is not a complete .lgo file. It must be integrated into a new .lgo file.</p>
<p>You can do this with a text editor. But here is a trick that uses the unix shell: </p><pre class="fragment">(grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit;\
 grep -v ^# a.lgo | egrep -v "\&lt;free\&gt;") &gt; b.lgo
</pre><p>This assumes that you have used <span class="tt">a.lgo</span> to analyze a real data set and several bootstrap replicates. The legofit output files are named <span class="tt">a2.legofit</span> (for the real data), and <span class="tt">a2boot*.legofit</span> (for the bootstrap replicates). The parentheses group the pipeline within it so that we can redirect the output with a single <span class="tt">&gt;</span>. Within the parentheses, the first command pulls the comments out of a.lgo and writes then to standard output. They will end up at the top of <span class="tt">b.lgo</span>. Next, the <span class="tt">pclgo</span> command writes lines in <span class="tt">.lgo</span> format, which define variables called "pc1", "pc2", etc., which refer to principal components. Following these, <span class="tt">pclgo</span> writes lines that re-express all the free variables of <span class="tt">a.lgo</span> as linear functions of the principal components. Following the <span class="tt">pclgo</span> command is a <span class="tt">grep -v</span> command that excludes comments. Its output is piped to an <span class="tt">egrep</span> command that excludes the free variables of <span class="tt">a.lgo</span>. All of this gets written into <span class="tt">b.lgo</span>. The result is a .lgo file that re-expresses all the free variables of <span class="tt">a.lgo</span> as functions of principal components.</p>
<p>By default, <span class="tt">pclgo</span> uses all principal components and therefore does not reduce the dimension of the search space. To reduce dimension, try <span class="tt">pclgo --tol 0.001</span>. This would exclude principal components that account for less than a fraction 0.001 of the variance.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2018, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span class="obfuscator">.nosp@m.</span>s@an<span class="obfuscator">.nosp@m.</span>thro.<span class="obfuscator">.nosp@m.</span>utah<span class="obfuscator">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for Legofit by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
