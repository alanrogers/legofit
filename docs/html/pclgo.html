<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: pclgo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">pclgo </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Re-express free variables in terms of principal components.</p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers</dd></dl>
<h1><a class="anchor" id="autotoc_md15"></a>
pclgo: re-express free variables in terms of principal components.</h1>
<p >First run <code>legofit</code> on a series of bootstrap or simulation replicates to produce a series of .legofiles. All these <code>legofit</code> runs should use the same .lgo file. <code>pclgo</code> reads this .lgo file and also all the .legofit files. It uses the .legofit files to do a principal components analysis of the free variables, and then rewrites a portion of the .lgo file, re-expressing all the free variables as linear functions of the principle components. In the rewrite, all the free variables are principal component scores and are therefore uncorrelated. The output of pclgo is not a complete .lgo file. It must be integrated into a new .lgo file.</p>
<p >You can do this with a text editor. But here is a trick that uses the unix shell: </p><pre class="fragment">(grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit;\
 grep -v ^# a.lgo | egrep -v "\&lt;free\&gt;") &gt; b.lgo
</pre><p> This assumes that you have used <code>a.lgo</code> to analyze a real data set and several bootstrap replicates. The legofit output files are named <code>a2.legofit</code> (for the real data), and <code>a2boot*.legofit</code> (for the bootstrap replicates). The parentheses group the pipeline within it so that we can redirect the output with a single <code>&gt;</code>. Within the parentheses, the first command pulls the comments out of a.lgo and writes then to standard output. They will end up at the top of <code>b.lgo</code>. Next, the <code>pclgo</code> command writes lines in <code>.lgo</code> format, which define variables called "pc1", "pc2", etc., which refer to principal components. Following these, <code>pclgo</code> writes lines that re-express all the free variables of <code>a.lgo</code> as linear functions of the principal components. Following the <code>pclgo</code> command is a <code>grep -v</code> command that excludes comments. Its output is piped to an <code>egrep</code> command that excludes the free variables of <code>a.lgo</code>. All of this gets written into <code>b.lgo</code>. The result is a .lgo file that re-expresses all the free variables of <code>a.lgo</code> as functions of principal components.</p>
<p >By default, <code>pclgo</code> uses all principal components and therefore does not reduce the dimension of the search space. To reduce dimension, try <code>pclgo --tol 0.001</code>. This would exclude principal components that account for less than a fraction 0.001 of the variance.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2018, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span class="obfuscator">.nosp@m.</span>s@an<span class="obfuscator">.nosp@m.</span>thro.<span class="obfuscator">.nosp@m.</span>utah<span class="obfuscator">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 21 2022 11:13:41 for Legofit by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
