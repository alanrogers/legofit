<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: boot.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site patterns.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">boot.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for a moving blocks bootstrap.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="boot_8h_source.html">boot.h</a>&quot;</code><br />
<code>#include &quot;misc.h&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:Boot" id="r_Boot"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_boot.html">Boot</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the all data involved in a moving blocks bootstrap.  <a href="struct_boot.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad50eea9b7a2a52b39359590f368d93ca" id="r_ad50eea9b7a2a52b39359590f368d93ca"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad50eea9b7a2a52b39359590f368d93ca">interpolate</a> (double p, double *v, long len)</td></tr>
<tr class="memdesc:ad50eea9b7a2a52b39359590f368d93ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate in order to approximate the value v[p*(len-1)].  <br /></td></tr>
<tr class="memitem:a421ff6ef1bff827e129cb9393906c49f" id="r_a421ff6ef1bff827e129cb9393906c49f"><td class="memItemLeft" align="right" valign="top"><a id="a421ff6ef1bff827e129cb9393906c49f" name="a421ff6ef1bff827e129cb9393906c49f"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><b>LInt_div_round</b> (long num, long denom)</td></tr>
<tr class="memdesc:a421ff6ef1bff827e129cb9393906c49f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide num by denom and round the result to the nearest integer. <br /></td></tr>
<tr class="memitem:a631133250092c76a947183e93d77602f" id="r_a631133250092c76a947183e93d77602f"><td class="memItemLeft" align="right" valign="top"><a id="a631133250092c76a947183e93d77602f" name="a631133250092c76a947183e93d77602f"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><b>Boot_multiplicity</b> (const <a class="el" href="struct_boot.html">Boot</a> *self, long snpndx, long rep)</td></tr>
<tr class="memdesc:a631133250092c76a947183e93d77602f"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many copies of snp with index snpndx are present in a given repetition (rep)? <br /></td></tr>
<tr class="memitem:a90bc0d69a048df5f27bdd01a419cc8df" id="r_a90bc0d69a048df5f27bdd01a419cc8df"><td class="memItemLeft" align="right" valign="top"><a id="a90bc0d69a048df5f27bdd01a419cc8df" name="a90bc0d69a048df5f27bdd01a419cc8df"></a>
<a class="el" href="struct_boot.html">Boot</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>Boot_new</b> (int nchr, long nsnpvec[nchr], long nrep, int npat, long blocksize, gsl_rng *rng)</td></tr>
<tr class="memdesc:a90bc0d69a048df5f27bdd01a419cc8df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for class <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a>. <br /></td></tr>
<tr class="memitem:aecd1482388bcd58a9e00fc369681cc5b" id="r_aecd1482388bcd58a9e00fc369681cc5b"><td class="memItemLeft" align="right" valign="top"><a id="aecd1482388bcd58a9e00fc369681cc5b" name="aecd1482388bcd58a9e00fc369681cc5b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Boot_sanityCheck</b> (const <a class="el" href="struct_boot.html">Boot</a> *self, const char *file, int line)</td></tr>
<tr class="memitem:aab1384a1fc638dddcf4cbe6b689a6284" id="r_aab1384a1fc638dddcf4cbe6b689a6284"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab1384a1fc638dddcf4cbe6b689a6284">Boot_add</a> (<a class="el" href="struct_boot.html">Boot</a> *self, int chr, long snpndx, int pat, double z)</td></tr>
<tr class="memdesc:aab1384a1fc638dddcf4cbe6b689a6284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add one site pattern contribution to a <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a> structure.  <br /></td></tr>
<tr class="memitem:a4dcd644fae0e8edc1ba29988e6b61300" id="r_a4dcd644fae0e8edc1ba29988e6b61300"><td class="memItemLeft" align="right" valign="top"><a id="a4dcd644fae0e8edc1ba29988e6b61300" name="a4dcd644fae0e8edc1ba29988e6b61300"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Boot_free</b> (<a class="el" href="struct_boot.html">Boot</a> *self)</td></tr>
<tr class="memdesc:a4dcd644fae0e8edc1ba29988e6b61300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="memitem:ab33573e57f0626755fc5e348b1524cd5" id="r_ab33573e57f0626755fc5e348b1524cd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab33573e57f0626755fc5e348b1524cd5">Boot_aggregate</a> (<a class="el" href="struct_boot.html">Boot</a> *self, int rep, int npat, double count[npat])</td></tr>
<tr class="memdesc:ab33573e57f0626755fc5e348b1524cd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add to an array the site pattern counts from a bootstrap replicate.  <br /></td></tr>
<tr class="memitem:af075fb66769c648957732892a025a112" id="r_af075fb66769c648957732892a025a112"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af075fb66769c648957732892a025a112">confidenceBounds</a> (double *lowBnd, double *highBnd, double confidence, long len, double v[len])</td></tr>
<tr class="memdesc:af075fb66769c648957732892a025a112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate confidence bounds from a vector of values representing samples drawn from the sampling distribution of some estimator.  <br /></td></tr>
<tr class="memitem:a67678e30e5654e425cf3ffc79462146f" id="r_a67678e30e5654e425cf3ffc79462146f"><td class="memItemLeft" align="right" valign="top"><a id="a67678e30e5654e425cf3ffc79462146f" name="a67678e30e5654e425cf3ffc79462146f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Boot_print</b> (const <a class="el" href="struct_boot.html">Boot</a> *self, FILE *ofp)</td></tr>
<tr class="memdesc:a67678e30e5654e425cf3ffc79462146f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a> object. <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for a moving blocks bootstrap. </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2016, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span class="obfuscator">.nosp@m.</span>s@an<span class="obfuscator">.nosp@m.</span>thro.<span class="obfuscator">.nosp@m.</span>utah<span class="obfuscator">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE".</dd></dl>
<p>This bootstrap treats all nucleotides as a single array, ignoring the distinction between chromosomes. Thus, blocks may span chromosomes. This should not cause problems with high-quality genomes, in which chromosomes are known. When a block spans two chromosomes, the sites within the block are less correlated within that block, but this doesn't violate any assumption.</p>
<p>I'm more worried about genomes that consist of many small contigs. With such genomes, nucleotides in different contigs may be tightly linked, and these linked contigs may end up in different blocks. This violates the assumption (of the moving-blocks bootstrap) that observations in different blocks are only weakly correlated. I'm not sure what effect this will have, but I fear it will make the confidence intervals too narrow. </p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="aab1384a1fc638dddcf4cbe6b689a6284" name="aab1384a1fc638dddcf4cbe6b689a6284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab1384a1fc638dddcf4cbe6b689a6284">&#9670;&#160;</a></span>Boot_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Boot_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_boot.html">Boot</a> *</td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>chr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>snpndx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>pat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add one site pattern contribution to a <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>The <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a> structure to modify. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chr</td><td>The index of the chromosome to modify. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snpndx</td><td>The index of the current snp. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pat</td><td>The index of the current site pattern. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>the contribution of the snp to the site pattern. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="#a631133250092c76a947183e93d77602f">Boot_multiplicity()</a>, <a class="el" href="struct_boot.html#abc66704a038459a05cac9f25e59254d2">Boot::count</a>, <a class="el" href="struct_boot.html#ab38e816e3213ec2b289fbe1f114ff860">Boot::cum</a>, and <a class="el" href="struct_boot.html#a31d65e5f6060ce22e1cc19c26e5bb5bb">Boot::nrep</a>.</p>

</div>
</div>
<a id="ab33573e57f0626755fc5e348b1524cd5" name="ab33573e57f0626755fc5e348b1524cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab33573e57f0626755fc5e348b1524cd5">&#9670;&#160;</a></span>Boot_aggregate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Boot_aggregate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_boot.html">Boot</a> *</td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>npat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>count</em></span>[npat]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add to an array the site pattern counts from a bootstrap replicate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>Points to a <a class="el" href="struct_boot.html" title="Contains the all data involved in a moving blocks bootstrap.">Boot</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">the</td><td>index of the bootstrap replicate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npat</td><td>the number of site patterns </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">count</td><td>An array of doubles. The function will add to count[i] the contribution of site pattern i in bootstrap replicate rep. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="struct_boot.html#abc66704a038459a05cac9f25e59254d2">Boot::count</a>, and <a class="el" href="struct_boot.html#ab27e80a1cc995464f064c754144c966e">Boot::npat</a>.</p>

</div>
</div>
<a id="af075fb66769c648957732892a025a112" name="af075fb66769c648957732892a025a112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af075fb66769c648957732892a025a112">&#9670;&#160;</a></span>confidenceBounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void confidenceBounds </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>lowBnd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>highBnd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>confidence</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>v</em></span>[len]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate confidence bounds from a vector of values representing samples drawn from the sampling distribution of some estimator. </p>
<p>To calculate the lower bound (*lowBnd), the function calculates the total probability mass in the tails (1 - confidence) and divides this into two equal parts to find p, the probability mass in each tail. It then estimates a value L such that a fraction p of the data values are less than or equal to L. To find this value, the function uses linear interpolation between the sorted list of data values.</p>
<p>The upper bound (*highBnd) is calculated in an analogous fashion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">lowBnd,highBnd</td><td>Calculated results will be written into these memory locations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">confidence</td><td>Fraction of sampling distribution that lies inside the confidence bounds. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The number of values inf v. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>The vector of values. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Side Effects:\n Sorts the vector v.</dt><dd></dd></dl>

<p class="reference">References <a class="el" href="misc_8c.html#a762ddf5508ef0417ffdb2ec0c10481f1">compareDoubles()</a>, and <a class="el" href="#ad50eea9b7a2a52b39359590f368d93ca">interpolate()</a>.</p>

</div>
</div>
<a id="ad50eea9b7a2a52b39359590f368d93ca" name="ad50eea9b7a2a52b39359590f368d93ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad50eea9b7a2a52b39359590f368d93ca">&#9670;&#160;</a></span>interpolate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double interpolate </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate in order to approximate the value v[p*(len-1)]. </p>
<p>Return NaN if len==0. </p>

<p class="reference">Referenced by <a class="el" href="#af075fb66769c648957732892a025a112">confidenceBounds()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for Legofit by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
