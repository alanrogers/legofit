<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: parse.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site  patterns.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">parse.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parse a .lgo file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;error.h&quot;</code><br />
<code>#include &quot;lblndx.h&quot;</code><br />
<code>#include &quot;misc.h&quot;</code><br />
<code>#include &quot;network.h&quot;</code><br />
<code>#include &quot;param.h&quot;</code><br />
<code>#include &quot;parse.h&quot;</code><br />
<code>#include &quot;parstore.h&quot;</code><br />
<code>#include &quot;ptrqueue.h&quot;</code><br />
<code>#include &quot;sampndx.h&quot;</code><br />
<code>#include &quot;strptrmap.h&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1ba28ca67412f721be296d7a7af9cded"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a1ba28ca67412f721be296d7a7af9cded">CHECK_TOKEN</a>(tok,  orig)</td></tr>
<tr class="memdesc:a1ba28ca67412f721be296d7a7af9cded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort if token is missing.  <a href="#a1ba28ca67412f721be296d7a7af9cded">More...</a><br /></td></tr>
<tr class="separator:a1ba28ca67412f721be296d7a7af9cded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac19bb5cf8e72d238271776a4acaf7ac8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#ac19bb5cf8e72d238271776a4acaf7ac8">ILLEGAL_INPUT</a>(x,  orig)</td></tr>
<tr class="memdesc:ac19bb5cf8e72d238271776a4acaf7ac8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort with an error message about illegal input.  <a href="#ac19bb5cf8e72d238271776a4acaf7ac8">More...</a><br /></td></tr>
<tr class="separator:ac19bb5cf8e72d238271776a4acaf7ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0745c365ff58c0169c992f13179ccfe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#ab0745c365ff58c0169c992f13179ccfe">DUPLICATE_PAR</a>(x,  orig)</td></tr>
<tr class="memdesc:ab0745c365ff58c0169c992f13179ccfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort with an error message about duplicate parameter definition.  <a href="#ab0745c365ff58c0169c992f13179ccfe">More...</a><br /></td></tr>
<tr class="separator:ab0745c365ff58c0169c992f13179ccfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f861c80cfb67bd8d136e7c0da74584e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a2f861c80cfb67bd8d136e7c0da74584e">ORDER_ERROR</a>(word)</td></tr>
<tr class="memdesc:a2f861c80cfb67bd8d136e7c0da74584e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input statements out of order.  <a href="#a2f861c80cfb67bd8d136e7c0da74584e">More...</a><br /></td></tr>
<tr class="separator:a2f861c80cfb67bd8d136e7c0da74584e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ab85e6cccd11772d709cc69e7a4baf9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a0ab85e6cccd11772d709cc69e7a4baf9">getDbl</a> (double *x, char **next, const char *orig)</td></tr>
<tr class="memdesc:a0ab85e6cccd11772d709cc69e7a4baf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpret token i as a double.  <a href="#a0ab85e6cccd11772d709cc69e7a4baf9">More...</a><br /></td></tr>
<tr class="separator:a0ab85e6cccd11772d709cc69e7a4baf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4962887f87bc97a3a6180aa3a629cda4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a4962887f87bc97a3a6180aa3a629cda4">getULong</a> (unsigned long *x, char **next, const char *orig)</td></tr>
<tr class="memdesc:a4962887f87bc97a3a6180aa3a629cda4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpret token i as an unsigned long integer.  <a href="#a4962887f87bc97a3a6180aa3a629cda4">More...</a><br /></td></tr>
<tr class="separator:a4962887f87bc97a3a6180aa3a629cda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84077abe63c860d0f693d498265c4cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#aa84077abe63c860d0f693d498265c4cb">getRange</a> (double x[2], char **next, const char *orig)</td></tr>
<tr class="memdesc:aa84077abe63c860d0f693d498265c4cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a range in form "[ 12, 34 ]".  <a href="#aa84077abe63c860d0f693d498265c4cb">More...</a><br /></td></tr>
<tr class="separator:aa84077abe63c860d0f693d498265c4cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1216d1779603bd478418ce114d955759"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a1216d1779603bd478418ce114d955759">parseParam</a> (char *next, unsigned ptype, <a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *parmap, <a class="el" href="struct_ptr_queue.html">PtrQueue</a> *fixedQ, <a class="el" href="struct_ptr_queue.html">PtrQueue</a> *freeQ, <a class="el" href="struct_ptr_queue.html">PtrQueue</a> *constrQ, <a class="el" href="struct_bounds.html">Bounds</a> *bnd, const char *orig)</td></tr>
<tr class="memdesc:a1216d1779603bd478418ce114d955759"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input defining a parameter.  <a href="#a1216d1779603bd478418ce114d955759">More...</a><br /></td></tr>
<tr class="separator:a1216d1779603bd478418ce114d955759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623fb8cce15a3da9e220172c1cf6f1af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a623fb8cce15a3da9e220172c1cf6f1af">parseSegment</a> (char *next, <a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *popmap, <a class="el" href="struct_samp_ndx.html">SampNdx</a> *sndx, <a class="el" href="struct_lbl_ndx.html">LblNdx</a> *lndx, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, const char *orig)</td></tr>
<tr class="memdesc:a623fb8cce15a3da9e220172c1cf6f1af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line describing a segment of the population tree.  <a href="#a623fb8cce15a3da9e220172c1cf6f1af">More...</a><br /></td></tr>
<tr class="separator:a623fb8cce15a3da9e220172c1cf6f1af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ac82bcb39c235bddaf023039f55e62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a14ac82bcb39c235bddaf023039f55e62">parseDerive</a> (char *next, <a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *popmap, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, const char *orig)</td></tr>
<tr class="memdesc:a14ac82bcb39c235bddaf023039f55e62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input describing a parent-offspring relationship between two nodes.  <a href="#a14ac82bcb39c235bddaf023039f55e62">More...</a><br /></td></tr>
<tr class="separator:a14ac82bcb39c235bddaf023039f55e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0097fe309c5a78dd50f5f344a7d0aaa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#ab0097fe309c5a78dd50f5f344a7d0aaa">parseMix</a> (char *next, <a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *popmap, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, const char *orig)</td></tr>
<tr class="memdesc:ab0097fe309c5a78dd50f5f344a7d0aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input describing gene flow.  <a href="#ab0097fe309c5a78dd50f5f344a7d0aaa">More...</a><br /></td></tr>
<tr class="separator:ab0097fe309c5a78dd50f5f344a7d0aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fda1fc614b7574a520b570444700ab0"><td class="memItemLeft" align="right" valign="top"><a id="a8fda1fc614b7574a520b570444700ab0"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>get_one_line</b> (size_t n, char buff[n], FILE *fp)</td></tr>
<tr class="separator:a8fda1fc614b7574a520b570444700ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6393c7196e116aaab536cc0e6e46ae06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ptr_pair.html">PtrPair</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a6393c7196e116aaab536cc0e6e46ae06">mktree</a> (FILE *fp, <a class="el" href="struct_samp_ndx.html">SampNdx</a> *sndx, <a class="el" href="struct_lbl_ndx.html">LblNdx</a> *lndx, <a class="el" href="struct_bounds.html">Bounds</a> *bnd)</td></tr>
<tr class="memdesc:a6393c7196e116aaab536cc0e6e46ae06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse an input file in .lgo format.  <a href="#a6393c7196e116aaab536cc0e6e46ae06">More...</a><br /></td></tr>
<tr class="separator:a6393c7196e116aaab536cc0e6e46ae06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c365f8ca3def04d05c614325464e4a"><td class="memItemLeft" align="right" valign="top"><a id="af0c365f8ca3def04d05c614325464e4a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#af0c365f8ca3def04d05c614325464e4a">countSegments</a> (FILE *fp)</td></tr>
<tr class="memdesc:af0c365f8ca3def04d05c614325464e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of "segment" statements in input file. <br /></td></tr>
<tr class="separator:af0c365f8ca3def04d05c614325464e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a29dc007556112a006bfe3e7bf362146a"><td class="memItemLeft" align="right" valign="top"><a id="a29dc007556112a006bfe3e7bf362146a"></a>
tipId_t&#160;</td><td class="memItemRight" valign="bottom"><b>union_all_samples</b></td></tr>
<tr class="separator:a29dc007556112a006bfe3e7bf362146a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parse a .lgo file. </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers</dd></dl>
<p>Consider the following tree of populations: </p><pre class="fragment"> a-------|
         |ab--|
 b--|bb--|    |
    |         |abc--
    |c--------|
</pre><p>t = 0 1 3 5.5 inf</p>
<p>In this tree, a, b, c, bb, ab, and abc represent segments of the population tree. The input file begins with a series of "segment" statements that define each of the segments in the tree. The segment statements also provide the time (backwards from the present in generations) at which the segment starts, and the size, twoN, of the population. Optionally, it also provides the number of haploid samples observed in this segment of the tree.</p>
<p>The statements that follow the segment statements describe how the segments are connected. The "mix" statement is used when a segment originates as a mixture of two ancestral segments. The "derive" statement is used when a segment derives from a single ancestral segment.</p>
<p>No segment can have more than two "parents" or more than two "children".</p>
<p>Here is input that would generate the tree above:</p>
<p>time fixed T0=0 time free Tc=1 time free Tab=3 time free Tabc=5.5 twoN free twoNa=100 twoN fixed twoNb=123 twoN free twoNc=213.4 twoN fixed twoNbb=32.1 twoN free twoNab=222 twoN fixed twoNabc=1.2e2 mixFrac free Mc=0.8 segment a t=T0 twoN=twoNa samples=1 segment b t=T0 twoN=twoNb samples=2 segment c t=Tc twoN=twoNc samples=1 segment bb t=Tc twoN=twoNbb segment ab t=Tab twoN=twoNab segment abc t=Tabc twoN=twoNabc mix b from bb + Mc * c derive a from ab derive bb from ab derive ab from abc derive c from abc</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2016, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1ba28ca67412f721be296d7a7af9cded"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ba28ca67412f721be296d7a7af9cded">&#9670;&nbsp;</a></span>CHECK_TOKEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_TOKEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tok, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">orig&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{                                  \</div><div class="line">        if((tok) == NULL) {                                        \</div><div class="line">            fprintf(stderr, <span class="stringliteral">&quot;%s:%d:&quot;</span>                               \</div><div class="line">                    <span class="stringliteral">&quot; input line incomplete in .lgo file.\n&quot;</span>,      \</div><div class="line">                    __FILE__,__LINE__);                            \</div><div class="line">            fprintf(stderr,<span class="stringliteral">&quot;  input: %s\n&quot;</span>, (orig));               \</div><div class="line">            exit(EXIT_FAILURE);                                    \</div><div class="line">        }                                                          \</div><div class="line">    }<span class="keywordflow">while</span>(0);</div></div><!-- fragment -->
<p>Abort if token is missing. </p>

<p class="reference">Referenced by <a class="el" href="parse_8c.html#a14ac82bcb39c235bddaf023039f55e62">parseDerive()</a>, <a class="el" href="parse_8c.html#ab0097fe309c5a78dd50f5f344a7d0aaa">parseMix()</a>, <a class="el" href="parse_8c.html#a1216d1779603bd478418ce114d955759">parseParam()</a>, and <a class="el" href="parse_8c.html#a623fb8cce15a3da9e220172c1cf6f1af">parseSegment()</a>.</p>

</div>
</div>
<a id="ab0745c365ff58c0169c992f13179ccfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0745c365ff58c0169c992f13179ccfe">&#9670;&nbsp;</a></span>DUPLICATE_PAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DUPLICATE_PAR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">orig&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span>{                                  \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;%s:%d: Duplicate parameter def: \&quot;%s\&quot;\n&quot;</span>, \</div><div class="line">                __FILE__,__LINE__, (x));                           \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;  input: %s\n&quot;</span>, (orig));                   \</div><div class="line">        exit(EXIT_FAILURE);                                        \</div><div class="line">    }<span class="keywordflow">while</span>(0)</div></div><!-- fragment -->
<p>Abort with an error message about duplicate parameter definition. </p>

</div>
</div>
<a id="ac19bb5cf8e72d238271776a4acaf7ac8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac19bb5cf8e72d238271776a4acaf7ac8">&#9670;&nbsp;</a></span>ILLEGAL_INPUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ILLEGAL_INPUT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">orig&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span>{                               \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;%s:%d: Illegal input: \&quot;%s\&quot;\n&quot;</span>,        \</div><div class="line">                __FILE__,__LINE__, (x));                        \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;  input: %s\n&quot;</span>, (orig));                \</div><div class="line">        exit(EXIT_FAILURE);                                     \</div><div class="line">    }<span class="keywordflow">while</span>(0)</div></div><!-- fragment -->
<p>Abort with an error message about illegal input. </p>

</div>
</div>
<a id="a2f861c80cfb67bd8d136e7c0da74584e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f861c80cfb67bd8d136e7c0da74584e">&#9670;&nbsp;</a></span>ORDER_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ORDER_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">word</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span>{                                           \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;%s:%d: Order error at \&quot;%s\&quot; in .lgo file.\n&quot;</span>,  \</div><div class="line">                __FILE__,__LINE__, (word));                             \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;Parameter definitions should come first\n&quot;</span>      \</div><div class="line">                <span class="stringliteral">&quot;   (twoN, time, mixFrac, and param),\n&quot;</span>                \</div><div class="line">                <span class="stringliteral">&quot;   then \&quot;segment\&quot; statements, and finally \&quot;mix\&quot;\n&quot;</span> \</div><div class="line">                <span class="stringliteral">&quot;   and \&quot;derive\&quot; statements.\n&quot;</span>);                     \</div><div class="line">        exit(EXIT_FAILURE);                                             \</div><div class="line">    }<span class="keywordflow">while</span>(0)</div></div><!-- fragment -->
<p>Input statements out of order. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0ab85e6cccd11772d709cc69e7a4baf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ab85e6cccd11772d709cc69e7a4baf9">&#9670;&nbsp;</a></span>getDbl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getDbl </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpret token i as a double. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>points to variable into which double value will be placed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">next</td><td>points to unparsed portion of input line </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa84077abe63c860d0f693d498265c4cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa84077abe63c860d0f693d498265c4cb">&#9670;&nbsp;</a></span>getRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getRange </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a range in form "[ 12, 34 ]". </p>
<p>Return 0 on success or 1 if range is not present. Abort if first character is "[" but the rest of the string is not interpretable as a range. </p>

<p class="reference">Referenced by <a class="el" href="parse_8c.html#a1216d1779603bd478418ce114d955759">parseParam()</a>.</p>

</div>
</div>
<a id="a4962887f87bc97a3a6180aa3a629cda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4962887f87bc97a3a6180aa3a629cda4">&#9670;&nbsp;</a></span>getULong()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getULong </td>
          <td>(</td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpret token i as an unsigned long integer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>points to variable into which value will be placed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">next</td><td>points to unparsed portion of input line integer. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">Referenced by <a class="el" href="parse_8c.html#a623fb8cce15a3da9e220172c1cf6f1af">parseSegment()</a>.</p>

</div>
</div>
<a id="a6393c7196e116aaab536cc0e6e46ae06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6393c7196e116aaab536cc0e6e46ae06">&#9670;&nbsp;</a></span>mktree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ptr_pair.html">PtrPair</a> mktree </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_samp_ndx.html">SampNdx</a> *&#160;</td>
          <td class="paramname"><em>sndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_lbl_ndx.html">LblNdx</a> *&#160;</td>
          <td class="paramname"><em>lndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bounds.html">Bounds</a> *&#160;</td>
          <td class="paramname"><em>bnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse an input file in .lgo format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>input file pointer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sndx</td><td>associates the index of each sample with the node to which it belongs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lndx</td><td>associated index of each sample with its name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>the bounds of each type of parameter </td></tr>
  </table>
  </dd>
</dl>
<p>Check the sanity of each node and make sure there is only one root. </p>

<p class="reference">References <a class="el" href="strptrmap_8c.html#a7192dd03782170200e1e3e5afd23bb21">StrPtrMap_new()</a>.</p>

</div>
</div>
<a id="a14ac82bcb39c235bddaf023039f55e62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ac82bcb39c235bddaf023039f55e62">&#9670;&nbsp;</a></span>parseDerive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseDerive </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *&#160;</td>
          <td class="paramname"><em>popmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input describing a parent-offspring relationship between two nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">next</td><td>unparsed portion of input line </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">popmap</td><td>associates names of segments with pointers to them. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="parse_8c.html#a1ba28ca67412f721be296d7a7af9cded">CHECK_TOKEN</a>, <a class="el" href="misc_8c.html#a9eb6f78e4c3ae557d5691facd373710d">nextWhitesepToken()</a>, <a class="el" href="misc_8c.html#a991311ce7332d25bf560d9da4c1f5819">stripWhiteSpace()</a>, and <a class="el" href="strptrmap_8c.html#aef98f306d884f33edf6dcc272b9f5d19">StrPtrMap_get()</a>.</p>

</div>
</div>
<a id="ab0097fe309c5a78dd50f5f344a7d0aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0097fe309c5a78dd50f5f344a7d0aaa">&#9670;&nbsp;</a></span>parseMix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseMix </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *&#160;</td>
          <td class="paramname"><em>popmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input describing gene flow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">next</td><td>unparsed portion of input line </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">popmap</td><td>associates names of segments with pointers to them. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="parse_8c.html#a1ba28ca67412f721be296d7a7af9cded">CHECK_TOKEN</a>, <a class="el" href="misc_8c.html#a9eb6f78e4c3ae557d5691facd373710d">nextWhitesepToken()</a>, <a class="el" href="parstore_8c.html#a59c74556bdf727073899ca778cd0823b">ParStore_getIndex()</a>, <a class="el" href="misc_8c.html#a991311ce7332d25bf560d9da4c1f5819">stripWhiteSpace()</a>, and <a class="el" href="strptrmap_8c.html#aef98f306d884f33edf6dcc272b9f5d19">StrPtrMap_get()</a>.</p>

</div>
</div>
<a id="a1216d1779603bd478418ce114d955759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1216d1779603bd478418ce114d955759">&#9670;&nbsp;</a></span>parseParam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseParam </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>ptype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *&#160;</td>
          <td class="paramname"><em>parmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_ptr_queue.html">PtrQueue</a> *&#160;</td>
          <td class="paramname"><em>fixedQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_ptr_queue.html">PtrQueue</a> *&#160;</td>
          <td class="paramname"><em>freeQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_ptr_queue.html">PtrQueue</a> *&#160;</td>
          <td class="paramname"><em>constrQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bounds.html">Bounds</a> *&#160;</td>
          <td class="paramname"><em>bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input defining a parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">next</td><td>points to unparsed portion of input line </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptype</td><td>TWON, TIME, or MIXFRAC </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>the bounds of each type of parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orig</td><td>original input line </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="parse_8c.html#a1ba28ca67412f721be296d7a7af9cded">CHECK_TOKEN</a>, <a class="el" href="parse_8c.html#aa84077abe63c860d0f693d498265c4cb">getRange()</a>, and <a class="el" href="misc_8c.html#a9eb6f78e4c3ae557d5691facd373710d">nextWhitesepToken()</a>.</p>

</div>
</div>
<a id="a623fb8cce15a3da9e220172c1cf6f1af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623fb8cce15a3da9e220172c1cf6f1af">&#9670;&nbsp;</a></span>parseSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseSegment </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_str_ptr_map.html">StrPtrMap</a> *&#160;</td>
          <td class="paramname"><em>popmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_samp_ndx.html">SampNdx</a> *&#160;</td>
          <td class="paramname"><em>sndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_lbl_ndx.html">LblNdx</a> *&#160;</td>
          <td class="paramname"><em>lndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line describing a segment of the population tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">next</td><td>pointer to unparsed portion of input line </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">popmap</td><td>associates names of segments with pointers to them. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sndx</td><td>associates the index of each sample with the node to which it belongs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lndx</td><td>associated index of each sample with its name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="parse_8c.html#a1ba28ca67412f721be296d7a7af9cded">CHECK_TOKEN</a>, <a class="el" href="parse_8c.html#a4962887f87bc97a3a6180aa3a629cda4">getULong()</a>, <a class="el" href="lblndx_8c.html#a1c29b9b02edd6f2ef227a668eb6c6b49">LblNdx_addSamples()</a>, <a class="el" href="misc_8c.html#a9eb6f78e4c3ae557d5691facd373710d">nextWhitesepToken()</a>, <a class="el" href="parstore_8c.html#a59c74556bdf727073899ca778cd0823b">ParStore_getIndex()</a>, <a class="el" href="sampndx_8c.html#a093ddb70c960d6f4a8ab1e72be890d43">SampNdx_addSamples()</a>, <a class="el" href="misc_8c.html#a991311ce7332d25bf560d9da4c1f5819">stripWhiteSpace()</a>, and <a class="el" href="strptrmap_8c.html#aced4d941a1481a6c0eb33b497d0e42e8">StrPtrMap_insert()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 15 2021 12:05:18 for Legofit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
