<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: branchtab.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site  patterns.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">branchtab.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="struct_hash.html">Hash</a> table associating key (an unsigned int encoding a site pattern) and value (a double representing the length of the ascending branch)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;branchtab.h&quot;</code><br />
<code>#include &quot;misc.h&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_branch_tab.html">BranchTab</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="struct_hash.html">Hash</a> table for branch lengths.  <a href="struct_branch_tab.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa43edf8f0c40865ca753e2a02f54c6b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aa43edf8f0c40865ca753e2a02f54c6b1">BranchTab_new</a> (unsigned nsamples)</td></tr>
<tr class="memdesc:aa43edf8f0c40865ca753e2a02f54c6b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> with room for site patterns associated with data in which the number of samples is "nsamples".  <a href="#aa43edf8f0c40865ca753e2a02f54c6b1">More...</a><br /></td></tr>
<tr class="separator:aa43edf8f0c40865ca753e2a02f54c6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad84450c0de5aa2d9b19ead9a04c395bd"><td class="memItemLeft" align="right" valign="top"><a id="ad84450c0de5aa2d9b19ead9a04c395bd"></a>
<a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_dup</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *old)</td></tr>
<tr class="separator:ad84450c0de5aa2d9b19ead9a04c395bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ffa76cd8d66a63b19747fa5a564697"><td class="memItemLeft" align="right" valign="top"><a id="a65ffa76cd8d66a63b19747fa5a564697"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a65ffa76cd8d66a63b19747fa5a564697">BranchTab_equals</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:a65ffa76cd8d66a63b19747fa5a564697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return 1 if two <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> objects are equal; 0 otherwise. <br /></td></tr>
<tr class="separator:a65ffa76cd8d66a63b19747fa5a564697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="memItemLeft" align="right" valign="top"><a id="aa1481ff0ad20e0d7585e7c8112cfbe03"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aa1481ff0ad20e0d7585e7c8112cfbe03">BranchTab_free</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>. <br /></td></tr>
<tr class="separator:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="memItemLeft" align="right" valign="top"><a id="a2892372faf88c0ce204ed4ab2c0d17c5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a2892372faf88c0ce204ed4ab2c0d17c5">BranchTab_hasSingletons</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return 1 if <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> includes singleton site patterns. <br /></td></tr>
<tr class="separator:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c03faa91251e9b889911755208841f"><td class="memItemLeft" align="right" valign="top"><a id="af5c03faa91251e9b889911755208841f"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#af5c03faa91251e9b889911755208841f">BranchTab_get</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, tipId_t key)</td></tr>
<tr class="memdesc:af5c03faa91251e9b889911755208841f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value corresponding to key. <br /></td></tr>
<tr class="separator:af5c03faa91251e9b889911755208841f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a1030ad7fe89b2f3ef4e3eae2a032642c">BranchTab_add</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, tipId_t key, long double value)</td></tr>
<tr class="memdesc:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a value to table.  <a href="#a1030ad7fe89b2f3ef4e3eae2a032642c">More...</a><br /></td></tr>
<tr class="separator:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43c5f9f118645e356d54c02f49156ba"><td class="memItemLeft" align="right" valign="top"><a id="af43c5f9f118645e356d54c02f49156ba"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#af43c5f9f118645e356d54c02f49156ba">BranchTab_size</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:af43c5f9f118645e356d54c02f49156ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of elements in the <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>. <br /></td></tr>
<tr class="separator:af43c5f9f118645e356d54c02f49156ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf26e0d8cd5cc4e188940132ad1af56"><td class="memItemLeft" align="right" valign="top"><a id="a7cf26e0d8cd5cc4e188940132ad1af56"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_sanityCheck</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, const char *file, int line)</td></tr>
<tr class="separator:a7cf26e0d8cd5cc4e188940132ad1af56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2023118406c4c5fc4880e1b23680feda"><td class="memItemLeft" align="right" valign="top"><a id="a2023118406c4c5fc4880e1b23680feda"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a2023118406c4c5fc4880e1b23680feda">BranchTab_divideBy</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, long double denom)</td></tr>
<tr class="memdesc:a2023118406c4c5fc4880e1b23680feda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide all values by denom. Return 0 on success, or 1 on failure. <br /></td></tr>
<tr class="separator:a2023118406c4c5fc4880e1b23680feda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71379e89161999b7f2e0ba14be0269a0"><td class="memItemLeft" align="right" valign="top"><a id="a71379e89161999b7f2e0ba14be0269a0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a71379e89161999b7f2e0ba14be0269a0">BranchTab_print</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self, FILE *fp)</td></tr>
<tr class="memdesc:a71379e89161999b7f2e0ba14be0269a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> to standard output. <br /></td></tr>
<tr class="separator:a71379e89161999b7f2e0ba14be0269a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3d78cd45bae5109fe951474ce1213d"><td class="memItemLeft" align="right" valign="top"><a id="add3d78cd45bae5109fe951474ce1213d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#add3d78cd45bae5109fe951474ce1213d">BranchTab_plusEquals</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:add3d78cd45bae5109fe951474ce1213d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add each entry in table rhs to table lhs. <br /></td></tr>
<tr class="separator:add3d78cd45bae5109fe951474ce1213d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779ea4b71525ee48476d64fab5734b8c"><td class="memItemLeft" align="right" valign="top"><a id="a779ea4b71525ee48476d64fab5734b8c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a779ea4b71525ee48476d64fab5734b8c">BranchTab_minusEquals</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:a779ea4b71525ee48476d64fab5734b8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtract each entry in table rhs from table lhs. <br /></td></tr>
<tr class="separator:a779ea4b71525ee48476d64fab5734b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd460c4e4b77e895dc1c13e47455737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aecd460c4e4b77e895dc1c13e47455737">BranchTab_toArrays</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, unsigned n, tipId_t key[n], long double value[n])</td></tr>
<tr class="memdesc:aecd460c4e4b77e895dc1c13e47455737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill arrays key and value with values in <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>.  <a href="#aecd460c4e4b77e895dc1c13e47455737">More...</a><br /></td></tr>
<tr class="separator:aecd460c4e4b77e895dc1c13e47455737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3b7d4a8751c13418e21cfd81245c60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a9c3b7d4a8751c13418e21cfd81245c60">BranchTab_collapse</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *old, tipId_t collapse)</td></tr>
<tr class="memdesc:a9c3b7d4a8751c13418e21cfd81245c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to a newly-allocated <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>, which is like "old", except that two or more of the populations in "old" are mapped into a single population in the new <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>.  <a href="#a9c3b7d4a8751c13418e21cfd81245c60">More...</a><br /></td></tr>
<tr class="separator:a9c3b7d4a8751c13418e21cfd81245c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4c2e88378dfc52fc752d627f505ea1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a8a4c2e88378dfc52fc752d627f505ea1">BranchTab_rmPops</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *old, tipId_t remove)</td></tr>
<tr class="memdesc:a8a4c2e88378dfc52fc752d627f505ea1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to newly-allocated <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>, which is like old, except that it lacks the populations indicated by the bits in "remove".  <a href="#a8a4c2e88378dfc52fc752d627f505ea1">More...</a><br /></td></tr>
<tr class="separator:a8a4c2e88378dfc52fc752d627f505ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c1f606d61d5e9fbc1593a88be68c616"><td class="memItemLeft" align="right" valign="top"><a id="a8c1f606d61d5e9fbc1593a88be68c616"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a8c1f606d61d5e9fbc1593a88be68c616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return sum of values in <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>. <br /></td></tr>
<tr class="separator:a8c1f606d61d5e9fbc1593a88be68c616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d871b7bd55d77e56cd829728d0087e"><td class="memItemLeft" align="right" valign="top"><a id="a99d871b7bd55d77e56cd829728d0087e"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a99d871b7bd55d77e56cd829728d0087e">BranchTab_entropy</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a99d871b7bd55d77e56cd829728d0087e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return negative of sum of p*ln(p) <br /></td></tr>
<tr class="separator:a99d871b7bd55d77e56cd829728d0087e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff87a05b73ad77d00b8fe0d311187942"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aff87a05b73ad77d00b8fe0d311187942">BranchTab_normalize</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:aff87a05b73ad77d00b8fe0d311187942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide all values by their sum.  <a href="#aff87a05b73ad77d00b8fe0d311187942">More...</a><br /></td></tr>
<tr class="separator:aff87a05b73ad77d00b8fe0d311187942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a5bbd10344c48096bae7a59f591344"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a67a5bbd10344c48096bae7a59f591344">BranchTab_KLdiverg</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *obs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *expt)</td></tr>
<tr class="memdesc:a67a5bbd10344c48096bae7a59f591344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate KL divergence from two <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> objects, which should be normalized before entering this function.  <a href="#a67a5bbd10344c48096bae7a59f591344">More...</a><br /></td></tr>
<tr class="separator:a67a5bbd10344c48096bae7a59f591344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a5eef8d5462b09e66d3d39e9eb29fe80b">BranchTab_negLnL</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *obs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *expt)</td></tr>
<tr class="memdesc:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative log likelihood.  <a href="#a5eef8d5462b09e66d3d39e9eb29fe80b">More...</a><br /></td></tr>
<tr class="separator:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a74a9991e9cf8eb1c0efde9cf3a356b89">make_collapse_map</a> (size_t n, tipId_t map[n], tipId_t collapse)</td></tr>
<tr class="memdesc:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off.  <a href="#a74a9991e9cf8eb1c0efde9cf3a356b89">More...</a><br /></td></tr>
<tr class="separator:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44299d268d95783f4e4ecdb7997b97fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a44299d268d95783f4e4ecdb7997b97fa">make_rm_map</a> (size_t n, tipId_t map[n], tipId_t remove)</td></tr>
<tr class="memdesc:a44299d268d95783f4e4ecdb7997b97fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off.  <a href="#a44299d268d95783f4e4ecdb7997b97fa">More...</a><br /></td></tr>
<tr class="separator:a44299d268d95783f4e4ecdb7997b97fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac857f49ab2fbb4ef96191f32abbbb4bd"><td class="memItemLeft" align="right" valign="top"><a id="ac857f49ab2fbb4ef96191f32abbbb4bd"></a>
tipId_t&#160;</td><td class="memItemRight" valign="bottom"><b>remap_bits</b> (size_t n, tipId_t map[n], tipId_t old)</td></tr>
<tr class="separator:ac857f49ab2fbb4ef96191f32abbbb4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="struct_hash.html">Hash</a> table associating key (an unsigned int encoding a site pattern) and value (a double representing the length of the ascending branch) </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2016, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1030ad7fe89b2f3ef4e3eae2a032642c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1030ad7fe89b2f3ef4e3eae2a032642c">&#9670;&nbsp;</a></span>BranchTab_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BranchTab_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a value to table. </p>
<p>If key already exists, new value is added to old one. </p>

<p class="reference">Referenced by <a class="el" href="gene_8c.html#a40b822d945d39d06b424a5064db6a8bd">Gene_tabulate()</a>, <a class="el" href="patprob_8c.html#ade7620d8ae5b169eaf1a57bd0b03e814">get_brlen()</a>, and <a class="el" href="resid_8c.html#af60e08041086546340a2c688d705990a">makeBranchTab()</a>.</p>

</div>
</div>
<a id="a9c3b7d4a8751c13418e21cfd81245c60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3b7d4a8751c13418e21cfd81245c60">&#9670;&nbsp;</a></span>BranchTab_collapse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_branch_tab.html">BranchTab</a>* BranchTab_collapse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>collapse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a pointer to a newly-allocated <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>, which is like "old", except that two or more of the populations in "old" are mapped into a single population in the new <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>. </p>

<p class="reference">References <a class="el" href="binary_8c.html#aea4c70d81dee1ba2d8299ef82ba32108">num1bits()</a>.</p>

</div>
</div>
<a id="a67a5bbd10344c48096bae7a59f591344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67a5bbd10344c48096bae7a59f591344">&#9670;&nbsp;</a></span>BranchTab_KLdiverg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double BranchTab_KLdiverg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>expt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate KL divergence from two <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> objects, which should be normalized before entering this function. </p>
<p>Use BranchTab_normalize to normalize. Function returns HUGE_VAL if there are observed values without corresponding values in expt. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>, and <a class="el" href="misc_8c.html#af33f46b2dc9a2a79fd524f578b99dc21">LDbl_near()</a>.</p>

</div>
</div>
<a id="a5eef8d5462b09e66d3d39e9eb29fe80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eef8d5462b09e66d3d39e9eb29fe80b">&#9670;&nbsp;</a></span>BranchTab_negLnL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double BranchTab_negLnL </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>expt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative log likelihood. </p>
<p>Multinomial model. lnL is sum across site patterns of x*log(p), where x is an observed site pattern count and p its probability. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>, and <a class="el" href="misc_8c.html#af33f46b2dc9a2a79fd524f578b99dc21">LDbl_near()</a>.</p>

</div>
</div>
<a id="aa43edf8f0c40865ca753e2a02f54c6b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa43edf8f0c40865ca753e2a02f54c6b1">&#9670;&nbsp;</a></span>BranchTab_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_branch_tab.html">BranchTab</a>* BranchTab_new </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>nsamples</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a> with room for site patterns associated with data in which the number of samples is "nsamples". </p>

<p class="reference">Referenced by <a class="el" href="resid_8c.html#af60e08041086546340a2c688d705990a">makeBranchTab()</a>.</p>

</div>
</div>
<a id="aff87a05b73ad77d00b8fe0d311187942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff87a05b73ad77d00b8fe0d311187942">&#9670;&nbsp;</a></span>BranchTab_normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BranchTab_normalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divide all values by their sum. </p>
<p>Return 0 on success, or 1 on failure. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>.</p>

</div>
</div>
<a id="a8a4c2e88378dfc52fc752d627f505ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4c2e88378dfc52fc752d627f505ea1">&#9670;&nbsp;</a></span>BranchTab_rmPops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_branch_tab.html">BranchTab</a>* BranchTab_rmPops </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>remove</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return pointer to newly-allocated <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>, which is like old, except that it lacks the populations indicated by the bits in "remove". </p>

<p class="reference">References <a class="el" href="binary_8c.html#aea4c70d81dee1ba2d8299ef82ba32108">num1bits()</a>.</p>

</div>
</div>
<a id="aecd460c4e4b77e895dc1c13e47455737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd460c4e4b77e895dc1c13e47455737">&#9670;&nbsp;</a></span>BranchTab_toArrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BranchTab_toArrays </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>key</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>value</em>[n]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill arrays key and value with values in <a class="el" href="struct_branch_tab.html" title="Hash table for branch lengths. ">BranchTab</a>. </p>
<p>On return, key[i] is the id of the i'th site pattern, and value[i] is the total branch length associated with that site pattern. </p>

</div>
</div>
<a id="a74a9991e9cf8eb1c0efde9cf3a356b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a9991e9cf8eb1c0efde9cf3a356b89">&#9670;&nbsp;</a></span>make_collapse_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_collapse_map </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>map</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>collapse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off. </p>
<p>The on bit indicates the position in the new id of the i'th bit in the old id.</p>
<p>All bits equal to 1 in collapse are mapped to the minimum bit in collapse. All bits with positions below that of this mininum bit are mapped to their original position. Bits that are above the minumum bit and are off in collapse are shifted right by "shift" places, where shift is one less than the number of on bits in collapse that are to the right of the bit in question.</p>
<p>On entry, n equals the number of samples, map is an array of n tipId_t values, and collapse is an integer whose "on" bits represent the set of samples that will be collapsed into a single sample. </p>

</div>
</div>
<a id="a44299d268d95783f4e4ecdb7997b97fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44299d268d95783f4e4ecdb7997b97fa">&#9670;&nbsp;</a></span>make_rm_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void make_rm_map </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>map</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>remove</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off. </p>
<p>The on bit indicates the position in the new id of the i'th bit in the old id.</p>
<p>All samples corresponding to an "on" bit in "remove" are deleted. Other samples (those not removed) have their bits right-shifted by a number of positions equal to the number of lower-order populations that have been removed.</p>
<p>On entry, n equals the number of samples, map is an array of n tipId_t values, and remove is an integer whose "on" bits represent the set of samples that will be removed. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 23 2021 18:27:15 for Legofit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
