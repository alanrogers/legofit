<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Legofit: branchtab.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Legofit
   </div>
   <div id="projectbrief">infers population history from nucleotide site</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">branchtab.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="struct_hash.html">Hash</a> table associating key (an unsigned int encoding a site pattern) and value (a double representing the length of the ascending branch)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;branchtab.h&quot;</code><br />
<code>#include &quot;misc.h&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_branch_tab.html">BranchTab</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a068106613fae11a5809fdd80ac76959b"><td class="memItemLeft" align="right" valign="top"><a id="a068106613fae11a5809fdd80ac76959b" name="a068106613fae11a5809fdd80ac76959b"></a>
<a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_new</b> (unsigned nsamples)</td></tr>
<tr class="memdesc:a068106613fae11a5809fdd80ac76959b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new <a class="el" href="struct_branch_tab.html">BranchTab</a> with room for site patterns associated with data in which the number of samples is "nsamples". <br /></td></tr>
<tr class="separator:a068106613fae11a5809fdd80ac76959b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc425ad0fe30c91d9a4658848c68bbcc"><td class="memItemLeft" align="right" valign="top"><a id="afc425ad0fe30c91d9a4658848c68bbcc" name="afc425ad0fe30c91d9a4658848c68bbcc"></a>
<a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_dup</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *old)</td></tr>
<tr class="separator:afc425ad0fe30c91d9a4658848c68bbcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ffa76cd8d66a63b19747fa5a564697"><td class="memItemLeft" align="right" valign="top"><a id="a65ffa76cd8d66a63b19747fa5a564697" name="a65ffa76cd8d66a63b19747fa5a564697"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_equals</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:a65ffa76cd8d66a63b19747fa5a564697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return 1 if two <a class="el" href="struct_branch_tab.html">BranchTab</a> objects are equal; 0 otherwise. <br /></td></tr>
<tr class="separator:a65ffa76cd8d66a63b19747fa5a564697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="memItemLeft" align="right" valign="top"><a id="aa1481ff0ad20e0d7585e7c8112cfbe03" name="aa1481ff0ad20e0d7585e7c8112cfbe03"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_free</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for <a class="el" href="struct_branch_tab.html">BranchTab</a>. <br /></td></tr>
<tr class="separator:aa1481ff0ad20e0d7585e7c8112cfbe03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="memItemLeft" align="right" valign="top"><a id="a2892372faf88c0ce204ed4ab2c0d17c5" name="a2892372faf88c0ce204ed4ab2c0d17c5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_hasSingletons</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return 1 if <a class="el" href="struct_branch_tab.html">BranchTab</a> includes singleton site patterns. <br /></td></tr>
<tr class="separator:a2892372faf88c0ce204ed4ab2c0d17c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c03faa91251e9b889911755208841f"><td class="memItemLeft" align="right" valign="top"><a id="af5c03faa91251e9b889911755208841f" name="af5c03faa91251e9b889911755208841f"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_get</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, tipId_t key)</td></tr>
<tr class="memdesc:af5c03faa91251e9b889911755208841f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value corresponding to key. <br /></td></tr>
<tr class="separator:af5c03faa91251e9b889911755208841f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="memItemLeft" align="right" valign="top"><a id="a1030ad7fe89b2f3ef4e3eae2a032642c" name="a1030ad7fe89b2f3ef4e3eae2a032642c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_add</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, tipId_t key, long double value)</td></tr>
<tr class="memdesc:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a value to table. <br /></td></tr>
<tr class="separator:a1030ad7fe89b2f3ef4e3eae2a032642c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43c5f9f118645e356d54c02f49156ba"><td class="memItemLeft" align="right" valign="top"><a id="af43c5f9f118645e356d54c02f49156ba" name="af43c5f9f118645e356d54c02f49156ba"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_size</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:af43c5f9f118645e356d54c02f49156ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of elements in the <a class="el" href="struct_branch_tab.html">BranchTab</a>. <br /></td></tr>
<tr class="separator:af43c5f9f118645e356d54c02f49156ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf26e0d8cd5cc4e188940132ad1af56"><td class="memItemLeft" align="right" valign="top"><a id="a7cf26e0d8cd5cc4e188940132ad1af56" name="a7cf26e0d8cd5cc4e188940132ad1af56"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_sanityCheck</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, const char *file, int line)</td></tr>
<tr class="separator:a7cf26e0d8cd5cc4e188940132ad1af56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2023118406c4c5fc4880e1b23680feda"><td class="memItemLeft" align="right" valign="top"><a id="a2023118406c4c5fc4880e1b23680feda" name="a2023118406c4c5fc4880e1b23680feda"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_divideBy</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, long double denom)</td></tr>
<tr class="memdesc:a2023118406c4c5fc4880e1b23680feda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide all values by denom. Return 0 on success, or 1 on failure. <br /></td></tr>
<tr class="separator:a2023118406c4c5fc4880e1b23680feda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71379e89161999b7f2e0ba14be0269a0"><td class="memItemLeft" align="right" valign="top"><a id="a71379e89161999b7f2e0ba14be0269a0" name="a71379e89161999b7f2e0ba14be0269a0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_print</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self, FILE *fp)</td></tr>
<tr class="memdesc:a71379e89161999b7f2e0ba14be0269a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a <a class="el" href="struct_branch_tab.html">BranchTab</a> to standard output. <br /></td></tr>
<tr class="separator:a71379e89161999b7f2e0ba14be0269a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3d78cd45bae5109fe951474ce1213d"><td class="memItemLeft" align="right" valign="top"><a id="add3d78cd45bae5109fe951474ce1213d" name="add3d78cd45bae5109fe951474ce1213d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_plusEquals</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:add3d78cd45bae5109fe951474ce1213d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add each entry in table rhs to table lhs. <br /></td></tr>
<tr class="separator:add3d78cd45bae5109fe951474ce1213d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779ea4b71525ee48476d64fab5734b8c"><td class="memItemLeft" align="right" valign="top"><a id="a779ea4b71525ee48476d64fab5734b8c" name="a779ea4b71525ee48476d64fab5734b8c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_minusEquals</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *lhs, <a class="el" href="struct_branch_tab.html">BranchTab</a> *rhs)</td></tr>
<tr class="memdesc:a779ea4b71525ee48476d64fab5734b8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtract each entry in table rhs from table lhs. <br /></td></tr>
<tr class="separator:a779ea4b71525ee48476d64fab5734b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd460c4e4b77e895dc1c13e47455737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aecd460c4e4b77e895dc1c13e47455737">BranchTab_toArrays</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self, unsigned n, tipId_t key[n], long double value[n])</td></tr>
<tr class="memdesc:aecd460c4e4b77e895dc1c13e47455737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill arrays key and value with values in <a class="el" href="struct_branch_tab.html">BranchTab</a>.  <a href="branchtab_8c.html#aecd460c4e4b77e895dc1c13e47455737">More...</a><br /></td></tr>
<tr class="separator:aecd460c4e4b77e895dc1c13e47455737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad943ea4b51c0896c86e3f21d2d3cf7a0"><td class="memItemLeft" align="right" valign="top"><a id="ad943ea4b51c0896c86e3f21d2d3cf7a0" name="ad943ea4b51c0896c86e3f21d2d3cf7a0"></a>
<a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_collapse</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *old, tipId_t collapse)</td></tr>
<tr class="memdesc:ad943ea4b51c0896c86e3f21d2d3cf7a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to a newly-allocated <a class="el" href="struct_branch_tab.html">BranchTab</a>, which is like "old", except that two or more of the populations in "old" are mapped into a single population in the new <a class="el" href="struct_branch_tab.html">BranchTab</a>. <br /></td></tr>
<tr class="separator:ad943ea4b51c0896c86e3f21d2d3cf7a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c99324461bf9e8dec07856598ca046"><td class="memItemLeft" align="right" valign="top"><a id="a70c99324461bf9e8dec07856598ca046" name="a70c99324461bf9e8dec07856598ca046"></a>
<a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_rmPops</b> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *old, tipId_t remove)</td></tr>
<tr class="memdesc:a70c99324461bf9e8dec07856598ca046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to newly-allocated <a class="el" href="struct_branch_tab.html">BranchTab</a>, which is like old, except that it lacks the populations indicated by the bits in "remove". <br /></td></tr>
<tr class="separator:a70c99324461bf9e8dec07856598ca046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c1f606d61d5e9fbc1593a88be68c616"><td class="memItemLeft" align="right" valign="top"><a id="a8c1f606d61d5e9fbc1593a88be68c616" name="a8c1f606d61d5e9fbc1593a88be68c616"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_sum</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a8c1f606d61d5e9fbc1593a88be68c616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return sum of values in <a class="el" href="struct_branch_tab.html">BranchTab</a>. <br /></td></tr>
<tr class="separator:a8c1f606d61d5e9fbc1593a88be68c616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d871b7bd55d77e56cd829728d0087e"><td class="memItemLeft" align="right" valign="top"><a id="a99d871b7bd55d77e56cd829728d0087e" name="a99d871b7bd55d77e56cd829728d0087e"></a>
long double&#160;</td><td class="memItemRight" valign="bottom"><b>BranchTab_entropy</b> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:a99d871b7bd55d77e56cd829728d0087e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return negative of sum of p*ln(p) <br /></td></tr>
<tr class="separator:a99d871b7bd55d77e56cd829728d0087e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff87a05b73ad77d00b8fe0d311187942"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aff87a05b73ad77d00b8fe0d311187942">BranchTab_normalize</a> (<a class="el" href="struct_branch_tab.html">BranchTab</a> *self)</td></tr>
<tr class="memdesc:aff87a05b73ad77d00b8fe0d311187942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide all values by their sum.  <a href="branchtab_8c.html#aff87a05b73ad77d00b8fe0d311187942">More...</a><br /></td></tr>
<tr class="separator:aff87a05b73ad77d00b8fe0d311187942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2586f84cbd30391c41c0a1cf94d7d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#aed2586f84cbd30391c41c0a1cf94d7d4">BranchTab_from_StrDblQueue</a> (<a class="el" href="struct_str_dbl_queue.html">StrDblQueue</a> *queue, <a class="el" href="struct_lbl_ndx.html">LblNdx</a> *lndx)</td></tr>
<tr class="memdesc:aed2586f84cbd30391c41c0a1cf94d7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <a class="el" href="struct_branch_tab.html">BranchTab</a> from a <a class="el" href="struct_str_dbl_queue.html">StrDblQueue</a>.  <a href="branchtab_8c.html#aed2586f84cbd30391c41c0a1cf94d7d4">More...</a><br /></td></tr>
<tr class="separator:aed2586f84cbd30391c41c0a1cf94d7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a5bbd10344c48096bae7a59f591344"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a67a5bbd10344c48096bae7a59f591344">BranchTab_KLdiverg</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *obs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *expt)</td></tr>
<tr class="memdesc:a67a5bbd10344c48096bae7a59f591344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate KL divergence from two <a class="el" href="struct_branch_tab.html">BranchTab</a> objects, which should be normalized before entering this function.  <a href="branchtab_8c.html#a67a5bbd10344c48096bae7a59f591344">More...</a><br /></td></tr>
<tr class="separator:a67a5bbd10344c48096bae7a59f591344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a5eef8d5462b09e66d3d39e9eb29fe80b">BranchTab_negLnL</a> (const <a class="el" href="struct_branch_tab.html">BranchTab</a> *obs, const <a class="el" href="struct_branch_tab.html">BranchTab</a> *expt)</td></tr>
<tr class="memdesc:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative log likelihood.  <a href="branchtab_8c.html#a5eef8d5462b09e66d3d39e9eb29fe80b">More...</a><br /></td></tr>
<tr class="separator:a5eef8d5462b09e66d3d39e9eb29fe80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#a74a9991e9cf8eb1c0efde9cf3a356b89">make_collapse_map</a> (size_t n, tipId_t map[n], tipId_t collapse)</td></tr>
<tr class="memdesc:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off.  <a href="branchtab_8c.html#a74a9991e9cf8eb1c0efde9cf3a356b89">More...</a><br /></td></tr>
<tr class="separator:a74a9991e9cf8eb1c0efde9cf3a356b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f412872f934af699f2e3ef927d599b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="branchtab_8c.html#ac0f412872f934af699f2e3ef927d599b">make_rm_map</a> (size_t n, tipId_t map[n], tipId_t remove)</td></tr>
<tr class="memdesc:ac0f412872f934af699f2e3ef927d599b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off.  <a href="branchtab_8c.html#ac0f412872f934af699f2e3ef927d599b">More...</a><br /></td></tr>
<tr class="separator:ac0f412872f934af699f2e3ef927d599b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3118e6172cda1c8985063668f4c4d357"><td class="memItemLeft" align="right" valign="top"><a id="a3118e6172cda1c8985063668f4c4d357" name="a3118e6172cda1c8985063668f4c4d357"></a>
tipId_t&#160;</td><td class="memItemRight" valign="bottom"><b>remap_bits</b> (size_t n, tipId_t map[n], tipId_t old)</td></tr>
<tr class="separator:a3118e6172cda1c8985063668f4c4d357"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="struct_hash.html">Hash</a> table associating key (an unsigned int encoding a site pattern) and value (a double representing the length of the ascending branch) </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2016, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span class="obfuscator">.nosp@m.</span>s@an<span class="obfuscator">.nosp@m.</span>thro.<span class="obfuscator">.nosp@m.</span>utah<span class="obfuscator">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aed2586f84cbd30391c41c0a1cf94d7d4" name="aed2586f84cbd30391c41c0a1cf94d7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2586f84cbd30391c41c0a1cf94d7d4">&#9670;&nbsp;</a></span>BranchTab_from_StrDblQueue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_branch_tab.html">BranchTab</a> * BranchTab_from_StrDblQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_str_dbl_queue.html">StrDblQueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_lbl_ndx.html">LblNdx</a> *&#160;</td>
          <td class="paramname"><em>lndx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a <a class="el" href="struct_branch_tab.html">BranchTab</a> from a <a class="el" href="struct_str_dbl_queue.html">StrDblQueue</a>. </p>
<p >The <a class="el" href="struct_lbl_ndx.html">LblNdx</a> translates site patterns from string representation to integer representation. Function returns a newly-allocated <a class="el" href="struct_branch_tab.html">BranchTab</a>. If queue is NULL, function returns NULL. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a1030ad7fe89b2f3ef4e3eae2a032642c">BranchTab_add()</a>, <a class="el" href="branchtab_8c.html#a068106613fae11a5809fdd80ac76959b">BranchTab_new()</a>, <a class="el" href="lblndx_8c.html#af3a2db1736ac1395e194fcac94697790">LblNdx_getTipId()</a>, <a class="el" href="lblndx_8c.html#ad9ca248e9ceae57ee2db1ac154616018">LblNdx_print()</a>, and <a class="el" href="lblndx_8c.html#a2520ffb094402f9d447d2756f882c188">LblNdx_size()</a>.</p>

</div>
</div>
<a id="a67a5bbd10344c48096bae7a59f591344" name="a67a5bbd10344c48096bae7a59f591344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67a5bbd10344c48096bae7a59f591344">&#9670;&nbsp;</a></span>BranchTab_KLdiverg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double BranchTab_KLdiverg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>expt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate KL divergence from two <a class="el" href="struct_branch_tab.html">BranchTab</a> objects, which should be normalized before entering this function. </p>
<p >Use BranchTab_normalize to normalize. Function returns HUGE_VAL if there are observed values without corresponding values in expt. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>, and <a class="el" href="misc_8c.html#af33f46b2dc9a2a79fd524f578b99dc21">LDbl_near()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cost_8c.html#a3b66214b0a48b2ec4ea2ff5b5d7553e8">costFun()</a>.</p>

</div>
</div>
<a id="a5eef8d5462b09e66d3d39e9eb29fe80b" name="a5eef8d5462b09e66d3d39e9eb29fe80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eef8d5462b09e66d3d39e9eb29fe80b">&#9670;&nbsp;</a></span>BranchTab_negLnL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double BranchTab_negLnL </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>expt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative log likelihood. </p>
<p >Multinomial model. lnL is sum across site patterns of x*log(p), where x is an observed site pattern count and p its probability. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>, and <a class="el" href="misc_8c.html#af33f46b2dc9a2a79fd524f578b99dc21">LDbl_near()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cost_8c.html#a3b66214b0a48b2ec4ea2ff5b5d7553e8">costFun()</a>.</p>

</div>
</div>
<a id="aff87a05b73ad77d00b8fe0d311187942" name="aff87a05b73ad77d00b8fe0d311187942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff87a05b73ad77d00b8fe0d311187942">&#9670;&nbsp;</a></span>BranchTab_normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BranchTab_normalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divide all values by their sum. </p>
<p >Return 0 on success, or 1 on failure. </p>

<p class="reference">References <a class="el" href="branchtab_8c.html#a8c1f606d61d5e9fbc1593a88be68c616">BranchTab_sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cost_8c.html#a3b66214b0a48b2ec4ea2ff5b5d7553e8">costFun()</a>.</p>

</div>
</div>
<a id="aecd460c4e4b77e895dc1c13e47455737" name="aecd460c4e4b77e895dc1c13e47455737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd460c4e4b77e895dc1c13e47455737">&#9670;&nbsp;</a></span>BranchTab_toArrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BranchTab_toArrays </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_branch_tab.html">BranchTab</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>key</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>value</em>[n]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill arrays key and value with values in <a class="el" href="struct_branch_tab.html">BranchTab</a>. </p>
<p >On return, key[i] is the id of the i'th site pattern, and value[i] is the total branch length associated with that site pattern. </p>

</div>
</div>
<a id="a74a9991e9cf8eb1c0efde9cf3a356b89" name="a74a9991e9cf8eb1c0efde9cf3a356b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a9991e9cf8eb1c0efde9cf3a356b89">&#9670;&nbsp;</a></span>make_collapse_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_collapse_map </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>map</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>collapse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off. </p>
<p >The on bit indicates the position in the new id of the i'th bit in the old id.</p>
<p >All bits equal to 1 in collapse are mapped to the minimum bit in collapse. All bits with positions below that of this mininum bit are mapped to their original position. Bits that are above the minumum bit and are off in collapse are shifted right by "shift" places, where shift is one less than the number of on bits in collapse that are to the right of the bit in question.</p>
<p >On entry, n equals the number of samples, map is an array of n tipId_t values, and collapse is an integer whose "on" bits represent the set of samples that will be collapsed into a single sample. <br  />
 </p>

</div>
</div>
<a id="ac0f412872f934af699f2e3ef927d599b" name="ac0f412872f934af699f2e3ef927d599b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f412872f934af699f2e3ef927d599b">&#9670;&nbsp;</a></span>make_rm_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_rm_map </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>map</em>[n], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tipId_t&#160;</td>
          <td class="paramname"><em>remove</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make map, an array whose i'th entry is an unsigned integer with one bit on and the rest off. </p>
<p >The on bit indicates the position in the new id of the i'th bit in the old id.</p>
<p >All samples corresponding to an "on" bit in "remove" are deleted. Other samples (those not removed) have their bits right-shifted by a number of positions equal to the number of lower-order populations that have been removed.</p>
<p >On entry, n equals the number of samples, map is an array of n tipId_t values, and remove is an integer whose "on" bits represent the set of samples that will be removed. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 21 2022 11:29:39 for Legofit by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
